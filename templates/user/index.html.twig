{% extends 'layout.html.twig' %}
    {% block content_header %}
        <section class="content-header">
            <h1>
                <small><i class="fa fa-list" aria-hidden="true"></i> List Users</small>
            </h1>
            <ol class="breadcrumb">
                <li><a href="{{ url('user_index') }}"><i class="fa fa-dashboard"></i> Users</a></li>
                <li class="active">List Users</li>
            </ol>
        </section>
    {% endblock %}

    {% block content %}
    <div class="col-md-12 col-sm-6 col-xs-12">
        <div class="box box-primary">

            <div class="x_content">
                {#{% include 'user/filter.html.twig' %}#}
                <div class="box-body">

                    <table id="datatable-responsive" class="table table-striped table-bordered dt-responsive nowrap table-hover" cellspacing="0">
                        <thead>
                        <tr>
                            {% set route = app.request.attributes.get('_route') %}
                            {% set params = app.request.attributes.get('_route_params')|merge(app.request.query.all) %}


                            {% if params.order is defined and params.sort == 'userId' and params.order == 'DESC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'userId',order:'ASC'})) }}">User Id <i class="fa fa-fw fa-sort-asc"></i></a></th>
                            {% elseif params.order is defined and params.sort == 'userId' and params.order == 'ASC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'userId', order:'DESC'})) }}">User Id <i class="fa fa-fw fa-sort-desc"></i></a></th>
                            {% else %}
                                <th><a href = "{{ url(route, params|merge({sort:'userId',order:'ASC'})) }}">User Id <i class="fa fa-fw fa-sort"></i></a></th>
                            {% endif %}


                            {% if params.order is defined and params.sort == 'user' and params.order == 'DESC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'user',order:'ASC'})) }}">User Display Name <i class="fa fa-fw fa-sort-asc"></i></a></th>
                            {% elseif params.order is defined and params.sort == 'user' and params.order == 'ASC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'user', order:'DESC'})) }}">User Display Name <i class="fa fa-fw fa-sort-desc"></i></a></th>
                            {% else %}
                                <th><a href = "{{ url(route, params|merge({sort:'user',order:'ASC'})) }}">User Display Name <i class="fa fa-fw fa-sort"></i></a></th>
                            {% endif %}


                            {% if params.order is defined and params.sort == 'username' and params.order == 'DESC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'username',order:'ASC'})) }}">Username <i class="fa fa-fw fa-sort-asc"></i></a></th>
                            {% elseif params.order is defined and params.sort == 'username' and params.order == 'ASC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'username', order:'DESC'})) }}">Username <i class="fa fa-fw fa-sort-desc"></i></a></th>
                            {% else %}
                                <th><a href = "{{ url(route, params|merge({sort:'username',order:'ASC'})) }}">Username <i class="fa fa-fw fa-sort"></i></a></th>
                            {% endif %}


                            {% if params.order is defined and params.sort == 'email' and params.order == 'DESC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'email',order:'ASC'})) }}">Email <i class="fa fa-fw fa-sort-asc"></i></a></th>
                            {% elseif params.order is defined and params.sort == 'email' and params.order == 'ASC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'email', order:'DESC'})) }}">Email <i class="fa fa-fw fa-sort-desc"></i></a></th>
                            {% else %}
                                <th><a href = "{{ url(route, params|merge({sort:'email',order:'ASC'})) }}">Email <i class="fa fa-fw fa-sort"></i></a></th>
                            {% endif %}


                            {#{% if params.order is defined and params.sort == 'department' and params.order == 'DESC' %}#}
                            {#<th><a href = "{{ url(route, params|merge({sort:'department',order:'ASC'})) }}">Department <i class="fa fa-fw fa-sort-asc"></i></a></th>#}
                            {#{% elseif params.order is defined and params.sort == 'department' and params.order == 'ASC' %}#}
                            {#<th><a href = "{{ url(route, params|merge({sort:'department', order:'DESC'})) }}">Department <i class="fa fa-fw fa-sort-desc"></i></a></th>#}
                            {#{% else %}#}
                            {#<th><a href = "{{ url(route, params|merge({sort:'department',order:'ASC'})) }}">Department <i class="fa fa-fw fa-sort"></i></a></th>#}
                            {#{% endif %}#}


                            {% if params.order is defined and params.sort == 'reportTo' and params.order == 'DESC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'reportTo',order:'ASC'})) }}">Report to <i class="fa fa-fw fa-sort-asc"></i></a></th>
                            {% elseif params.order is defined and params.sort == 'reportTo' and params.order == 'ASC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'reportTo', order:'DESC'})) }}">Report to <i class="fa fa-fw fa-sort-desc"></i></a></th>
                            {% else %}
                                <th><a href = "{{ url(route, params|merge({sort:'reportTo',order:'ASC'})) }}">Report to <i class="fa fa-fw fa-sort"></i></a></th>
                            {% endif %}


                            {#{% if params.order is defined and params.sort == 'position' and params.order == 'DESC' %}#}
                            {#<th><a href = "{{ url(route, params|merge({sort:'position',order:'ASC'})) }}">Position <i class="fa fa-fw fa-sort-asc"></i></a></th>#}
                            {#{% elseif params.order is defined and params.sort == 'position' and params.order == 'ASC' %}#}
                            {#<th><a href = "{{ url(route, params|merge({sort:'position', order:'DESC'})) }}">Position <i class="fa fa-fw fa-sort-desc"></i></a></th>#}
                            {#{% else %}#}
                            {#<th><a href = "{{ url(route, params|merge({sort:'position',order:'ASC'})) }}">Position <i class="fa fa-fw fa-sort"></i></a></th>#}
                            {#{% endif %}#}

                            <th>Is Active</th>

                            {% if params.order is defined and params.sort == 'createdAt' and params.order == 'DESC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'createdAt',order:'ASC'})) }}">Created At <i class="fa fa-fw fa-sort-asc"></i></a></th>
                            {% elseif params.order is defined and params.sort == 'createdAt' and params.order == 'ASC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'createdAt', order:'DESC'})) }}">Created At <i class="fa fa-fw fa-sort-desc"></i></a></th>
                            {% else %}
                                <th><a href = "{{ url(route, params|merge({sort:'createdAt',order:'ASC'})) }}">Created At <i class="fa fa-fw fa-sort"></i></a></th>
                            {% endif %}


                            {% if params.order is defined and params.sort == 'updatedAt' and params.order == 'DESC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'updatedAt',order:'ASC'})) }}">Updated At <i class="fa fa-fw fa-sort-asc"></i></a></th>
                            {% elseif params.order is defined and params.sort == 'updatedAt' and params.order == 'ASC' %}
                                <th><a href = "{{ url(route, params|merge({sort:'updatedAt', order:'DESC'})) }}">Updated At <i class="fa fa-fw fa-sort-desc"></i></a></th>
                            {% else %}
                                <th><a href = "{{ url(route, params|merge({sort:'updatedAt',order:'ASC'})) }}">Updated At <i class="fa fa-fw fa-sort"></i></a></th>
                            {% endif %}

                            <th>Manage</th>

                        </tr>
                        </thead>
                        <tbody>
                        {% if users|length > 0%}
                            {% for user in users %}
                                <tr>
                                    <td>
                                        <a href="{{ path('user_show', { 'id': user.id }) }}">{{ user.id }}</a>
                                    </td>
                                    <td>{{ user }}</td>
                                    <td>{{ user.username }}</td>
                                    <td>{{ user.email }}</td>
                                    {#<td>{{ user.department }}</td>#}
                                    <td>{% if user.parent %}{{ user.parent.firstName }} {{ user.parent.lastName }}{% endif %}</td>
                                    {#<td>{{ user.position }}</td>#}
                                    <td>{% if user.isActive %}Yes{% else %}No{% endif %}</td>
                                    <td>{% if user.createdAt %}{{ user.createdAt|date('Y-m-d H:i:s') }}{% endif %}</td>
                                    <td>{% if user.updatedAt %}{{ user.updatedAt|date('Y-m-d H:i:s') }}{% endif %}</td>
                                    <td class="actions">
                                        <a href="{{ path('user_show', { 'id': user.id }) }}" class="btn-sm bg-orange no-wrap">
                                            <i class="fa fa-user"></i><span class="hidden-xs hidden-sm"> Profile</span>
                                        </a>
                                        <a href="{{ path('user_edit', { 'id': user.id }) }}" class="btn-sm bg-green no-wrap">
                                            <i class="fa fa-cog"></i><span class="hidden-xs hidden-sm"> Edit User</span>
                                        </a>
                                        {% if is_granted('ROLE_ALLOWED_TO_SWITCH') %}
                                            <a href="{{ url('app_homepage', { '_switch_user': user.username }) }}" class="btn-sm bg-purple no-wrap">
                                                <i class="fa fa-user-secret"></i><span class="hidden-xs hidden-sm"> Impersonate</span>
                                            </a>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        {% endif %}
                        </tbody>
                    </table>
                </div>

                {% include 'paginator.html.twig' with { 'paginator': users } only %}
            </div>
        </div>
    </div>

    {% endblock %}
